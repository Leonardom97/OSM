# OSM - Sistema de Gesti√≥n Operacional

![OSM Logo](assets/img/Sin%20t√≠tulo-2.png)

## üìã Tabla de Contenidos
- [Funcionamiento General](#funcionamiento-general)
- [Motivo de Desarrollo y Prop√≥sito](#motivo-de-desarrollo-y-prop√≥sito)
- [M√≥dulos y Estado de Desarrollo](#m√≥dulos-y-estado-de-desarrollo)
- [Arquitectura del Sistema](#arquitectura-del-sistema)
- [Diagramas de Flujo](#diagramas-de-flujo)
- [Base de Datos](#base-de-datos)
- [Instalaci√≥n](#instalaci√≥n)
- [Tecnolog√≠as Utilizadas](#tecnolog√≠as-utilizadas)

---

## üéØ Funcionamiento General

OSM (Sistema de Gesti√≥n Operacional) es una aplicaci√≥n web empresarial dise√±ada para gestionar integralmente las operaciones de una empresa agroindustrial de producci√≥n de aceite de palma. El sistema centraliza la administraci√≥n de:

### Caracter√≠sticas Principales

1. **Autenticaci√≥n Dual**
   - Sistema de login para Administradores
   - Sistema de login para Colaboradores
   - Gesti√≥n de sesiones seguras con control de intentos fallidos
   - Roles y permisos diferenciados

2. **Panel de Control Central**
   - Dashboard con m√©tricas en tiempo real
   - Indicadores de usuarios registrados
   - Estad√≠sticas de colaboradores activos
   - Seguimiento de capacitaciones
   - Programaci√≥n de fechas de corte

3. **Gesti√≥n de Usuarios y Colaboradores**
   - Registro y administraci√≥n de usuarios del sistema
   - Base de datos completa de colaboradores (1200+ registros)
   - Gesti√≥n de cargos, √°reas y sub-√°reas
   - Control de situaci√≥n laboral (Activo, Vacaciones, Pendiente, etc.)

4. **Sistema de Capacitaciones**
   - Programaci√≥n de capacitaciones por cargo y √°rea
   - Registro de asistencia
   - Sistema de notificaciones autom√°ticas
   - Seguimiento de progreso individual
   - Gesti√≥n de temas, lugares y tipos de actividad

5. **M√≥dulo Agron√≥mico**
   - Monitoreo de plagas y enfermedades
   - Control de fertilizaci√≥n
   - Gesti√≥n de cosecha de fruta
   - Programaci√≥n de fechas de corte
   - Seguimiento de mantenimientos agr√≠colas
   - Control de sanidad vegetal
   - Monitoreo de trampas
   - Gesti√≥n de nivel fre√°tico

6. **Sistema de Pesaje**
   - Registro de pesaje de materia prima
   - Control de entrada de fruta fresca
   - Integraci√≥n con b√°scula

---

## üéì Motivo de Desarrollo y Prop√≥sito

### Contexto del Proyecto

El sistema OSM fue desarrollado para resolver las necesidades operacionales de una empresa agroindustrial dedicada a la producci√≥n de aceite de palma africana. Antes de la implementaci√≥n de OSM, la empresa enfrentaba varios desaf√≠os:

1. **Dispersi√≥n de Informaci√≥n**: Datos operacionales distribuidos en m√∫ltiples sistemas incompatibles
2. **Gesti√≥n Manual**: Procesos cr√≠ticos realizados de forma manual o en hojas de c√°lculo
3. **Falta de Trazabilidad**: Dificultad para rastrear el progreso de capacitaciones y cumplimiento normativo
4. **Ineficiencia en Comunicaci√≥n**: Carencia de un sistema centralizado de notificaciones
5. **Desintegraci√≥n de M√≥dulos**: Operaciones agr√≠colas, administrativas e industriales operando de forma aislada

### Prop√≥sito del Sistema

**Objetivo Principal**: Centralizar y automatizar la gesti√≥n operacional completa de la empresa, desde la administraci√≥n de recursos humanos hasta el control de procesos agr√≠colas e industriales.

**Objetivos Espec√≠ficos**:

1. **Cumplimiento Normativo**
   - Garantizar el cumplimiento de certificaciones (RSPO, ISCC, Org√°nico)
   - Mantener registros actualizados de capacitaciones obligatorias
   - Documentar trazabilidad de procesos

2. **Eficiencia Operacional**
   - Reducir tiempo de gesti√≥n administrativa
   - Automatizar notificaciones y alertas
   - Centralizar informaci√≥n cr√≠tica del negocio
   - Facilitar toma de decisiones basada en datos

3. **Gesti√≥n del Talento**
   - Control integral de colaboradores
   - Seguimiento de capacitaciones y desarrollo profesional
   - Gesti√≥n de competencias por cargo

4. **Control Agr√≠cola**
   - Monitoreo en tiempo real de cultivos
   - Planificaci√≥n de cosechas
   - Control fitosanitario
   - Gesti√≥n de aplicaciones agron√≥micas

5. **Integraci√≥n Operacional**
   - Conexi√≥n entre m√≥dulos administrativos, agr√≠colas e industriales
   - Flujo de informaci√≥n desde campo hasta planta
   - Reporter√≠a unificada

### Beneficios Esperados

- ‚úÖ Reducci√≥n del 60% en tiempo de gesti√≥n administrativa
- ‚úÖ Trazabilidad completa de operaciones agr√≠colas
- ‚úÖ Cumplimiento del 100% en capacitaciones obligatorias
- ‚úÖ Centralizaci√≥n de informaci√≥n en una √∫nica plataforma
- ‚úÖ Mejora en la comunicaci√≥n organizacional
- ‚úÖ Reducci√≥n de errores por registro manual

---

## üìä M√≥dulos y Estado de Desarrollo

### Resumen de Avance

| M√≥dulo | Completado | En Desarrollo | Planificado | Total |
|--------|-----------|---------------|-------------|-------|
| **m_admin** | 90% | 10% | 0% | 100% |
| **m_capacitaciones** | 85% | 10% | 5% | 100% |
| **m_agronomia** | 75% | 20% | 5% | 100% |
| **m_bascula** | 70% | 15% | 15% | 100% |
| **Core System** | 95% | 5% | 0% | 100% |
| **TOTAL GENERAL** | **82%** | **13%** | **5%** | **100%** |

---

### 1. **M√≥dulo de Administraci√≥n (m_admin)** - 90% Completado

**Funcionalidades Implementadas** (90%):
- ‚úÖ Gesti√≥n de usuarios administradores
- ‚úÖ CRUD completo de colaboradores
- ‚úÖ Asignaci√≥n de roles y permisos
- ‚úÖ Gesti√≥n de cargos y √°reas
- ‚úÖ Sincronizaci√≥n con base de datos SQL Server (colaboradores)
- ‚úÖ Interfaz de edici√≥n de usuarios
- ‚úÖ Interfaz de edici√≥n de colaboradores
- ‚úÖ Sistema de b√∫squeda y filtrado

**En Desarrollo** (10%):
- üîÑ Panel de auditor√≠a de cambios
- üîÑ Reportes avanzados de usuarios

**Componentes**:
- `ed_usuario.html` - Edici√≥n de usuarios administradores
- `ed_uscolaboradores.html` - Edici√≥n de colaboradores
- `usuarios_api.php` - API de gesti√≥n de usuarios
- `colaboradores_api.php` - API de gesti√≥n de colaboradores
- `usuarios.js`, `colaboradores.js` - L√≥gica del frontend

---

### 2. **M√≥dulo de Capacitaciones (m_capacitaciones)** - 85% Completado

**Funcionalidades Implementadas** (85%):
- ‚úÖ Registro de capacitaciones (formulario completo)
- ‚úÖ Gesti√≥n de asistentes con importaci√≥n CSV
- ‚úÖ Programaci√≥n de capacitaciones por cargo
- ‚úÖ Sistema de notificaciones autom√°ticas
- ‚úÖ C√°lculo de fechas de vencimiento
- ‚úÖ Consulta y b√∫squeda de capacitaciones hist√≥ricas
- ‚úÖ Edici√≥n de capacitaciones existentes
- ‚úÖ Seguimiento de progreso por colaborador
- ‚úÖ Gesti√≥n de temas (81 temas configurados)
- ‚úÖ Gesti√≥n de tipos de actividad
- ‚úÖ Gesti√≥n de lugares de capacitaci√≥n
- ‚úÖ Gesti√≥n de procesos
- ‚úÖ Upload de archivos adjuntos
- ‚úÖ Vista de progreso de capacitaciones

**En Desarrollo** (10%):
- üîÑ Generaci√≥n autom√°tica de certificados
- üîÑ Reportes estad√≠sticos avanzados

**Planificado** (5%):
- üìã Integraci√≥n con calendario corporativo
- üìã Recordatorios por email/SMS

**Componentes**:
- `formulario.html` - Registro de nueva capacitaci√≥n
- `ed_formulario.html` - Edici√≥n de capacitaci√≥n existente
- `programacion.html` - Programaci√≥n de capacitaciones
- `Consultas_capacitacion.html` - B√∫squeda y consulta hist√≥rica
- APIs: `formulario_api.php`, `ed_formulario_api.php`, `programacion_api.php`, `consultas_capacitacion_api.php`, `notificaciones_api.php`, `progreso_api.php`, `file_upload_api.php`
- Scripts JS: `formulario.js`, `ed_formulario.js`, `programacion.js`, `consulta-cap.js`, `capacitaciones.js`

**Tablas de Base de Datos**:
- `cap_formulario` - Capacitaciones registradas
- `cap_formulario_asistente` - Asistentes por capacitaci√≥n
- `cap_programacion` - Programaci√≥n por cargo
- `cap_notificaciones` - Notificaciones de vencimiento
- `cap_tema` - Cat√°logo de temas (81 registros)
- `cap_tipo_actividad` - Tipos (5 registros)
- `cap_lugar` - Lugares disponibles
- `cap_proceso` - Procesos asociados
- `v_progreso_capacitaciones` - Vista de progreso

---

### 3. **M√≥dulo Agron√≥mico (m_agronomia)** - 75% Completado

Este es el m√≥dulo m√°s extenso del sistema con 98 archivos entre HTML, PHP y JavaScript.

**Funcionalidades Implementadas** (75%):
- ‚úÖ Monitoreo de plagas
- ‚úÖ Control de enfermedades
- ‚úÖ Gesti√≥n de fertilizaci√≥n org√°nica y qu√≠mica
- ‚úÖ Registro de cosecha de fruta
- ‚úÖ Control de calidad de fruta
- ‚úÖ Monitoreo de trampas
- ‚úÖ Gesti√≥n de mantenimientos agr√≠colas
- ‚úÖ Control de oficios varios en palma
- ‚úÖ Monitoreo de nivel fre√°tico
- ‚úÖ Programaci√≥n de fechas de corte
- ‚úÖ Aprobaci√≥n de monitoreos generales
- ‚úÖ Sistema de eventos pendientes
- ‚úÖ Reportes de lotes con monitoreo

**En Desarrollo** (20%):
- üîÑ Dashboard anal√≠tico de producci√≥n
- üîÑ Predicci√≥n de cosechas
- üîÑ Integraci√≥n con sensores IoT
- üîÑ Mapas de calor de incidencia

**Planificado** (5%):
- üìã M√≥dulo de agricultura de precisi√≥n
- üìã Sistema de alertas tempranas

**Componentes Principales**:
- `tb_agronomia.html` - Tabla principal de agronom√≠a
- `f_cortes.html` - Programaci√≥n de fechas de corte
- M√°s de 50 archivos PHP para diferentes operaciones agron√≥micas
- Scripts especializados para cada sub-proceso

**Sub-procesos Agron√≥micos**:
1. **Monitoreo de Plagas**: Registro y seguimiento de incidencia de plagas
2. **Control Fitosanitario**: Gesti√≥n de aplicaciones y tratamientos
3. **Fertilizaci√≥n**: Control de aplicaciones org√°nicas y qu√≠micas
4. **Cosecha**: Registro de RFF (Racimos de Fruta Fresca)
5. **Calidad**: Control de calidad de fruta
6. **Mantenimiento**: Gesti√≥n de labores de mantenimiento
7. **Trampas**: Monitoreo de trampas para control de plagas
8. **Nivel Fre√°tico**: Control de agua subterr√°nea

**Tablas Principales**:
- `agr_fecha_corte` - Programaci√≥n de cortes
- M√∫ltiples tablas para diferentes aspectos agron√≥micos

---

### 4. **M√≥dulo de B√°scula (m_bascula)** - 70% Completado

**Funcionalidades Implementadas** (70%):
- ‚úÖ Registro de pesaje
- ‚úÖ Interfaz de b√°scula
- ‚úÖ Registro de RFF entrante

**En Desarrollo** (15%):
- üîÑ Integraci√≥n directa con b√°scula electr√≥nica
- üîÑ Generaci√≥n de tickets autom√°ticos

**Planificado** (15%):
- üìã An√°lisis de tendencias de peso
- üìã Alertas de anomal√≠as en pesaje
- üìã Reportes de productividad por lote

**Componentes**:
- `Pesaje.html` - Interface de registro de pesaje
- APIs asociadas en carpeta assets

---

### 5. **Sistema Core** - 95% Completado

**Funcionalidades Implementadas** (95%):
- ‚úÖ Sistema de autenticaci√≥n dual (Administradores/Colaboradores)
- ‚úÖ Gesti√≥n de sesiones con PHP
- ‚úÖ Control de intentos de login
- ‚úÖ Sistema de roles y permisos
- ‚úÖ Navegaci√≥n din√°mica (sidebar y navbar)
- ‚úÖ Panel de control con m√©tricas
- ‚úÖ Configuraci√≥n web din√°mica
- ‚úÖ Guard de autenticaci√≥n
- ‚úÖ Gesti√≥n de sesiones activas
- ‚úÖ Logout seguro
- ‚úÖ Dise√±o responsivo con Bootstrap 5

**En Desarrollo** (5%):
- üîÑ Sistema de logs de auditor√≠a
- üîÑ Panel de monitoreo de sesiones

**Componentes Core**:
- `index.html` - P√°gina de login
- `panel.html` - Dashboard principal
- `sesiones.html` - Gesti√≥n de sesiones
- `Usuarios.html` - Listado de usuarios
- `php/login_admin.php` - Autenticaci√≥n administradores
- `php/login_colaborador.php` - Autenticaci√≥n colaboradores
- `php/session_manager.php` - Gesti√≥n de sesiones
- `php/session_management_api.php` - API de sesiones
- `php/verificar_sesion.php` - Verificaci√≥n de sesi√≥n activa
- `php/logout.php` - Cierre de sesi√≥n
- `php/db_postgres.php` - Conexi√≥n PostgreSQL
- `php/db_sqlserver.php` - Conexi√≥n SQL Server
- `assets/js/login.js` - L√≥gica de login
- `assets/js/navbar.js` - Navegaci√≥n din√°mica
- `assets/js/sidebar.js` - Men√∫ lateral din√°mico
- `assets/js/auth_guard.js` - Protecci√≥n de rutas

**Tablas Core**:
- `adm_usuarios` - Usuarios administradores
- `adm_colaboradores` - Colaboradores (1200+ registros)
- `adm_sesiones` - Sesiones activas
- `adm_intentos_login` - Control de intentos
- `adm_roles` - Roles del sistema
- `adm_usuario_roles` - Asignaci√≥n de roles
- `adm_cargos` - Cat√°logo de cargos (143 registros)
- `adm_√°rea` - √Åreas organizacionales
- `adm_situaci√≥n` - Estados de colaboradores
- `adm_empresa` - Empresas del grupo
- `adm_webmain` - Configuraci√≥n web

---

## üèóÔ∏è Arquitectura del Sistema

### Estructura de Archivos

```
OSM/
‚îú‚îÄ‚îÄ index.html                 # P√°gina de login
‚îú‚îÄ‚îÄ panel.html                 # Dashboard principal
‚îú‚îÄ‚îÄ sesiones.html             # Gesti√≥n de sesiones
‚îú‚îÄ‚îÄ Usuarios.html             # Listado de usuarios
‚îú‚îÄ‚îÄ assets/                   # Recursos compartidos
‚îÇ   ‚îú‚îÄ‚îÄ bootstrap/           # Framework CSS
‚îÇ   ‚îú‚îÄ‚îÄ css/                 # Estilos personalizados
‚îÇ   ‚îú‚îÄ‚îÄ fonts/               # Iconos FontAwesome
‚îÇ   ‚îú‚îÄ‚îÄ img/                 # Im√°genes y logos
‚îÇ   ‚îî‚îÄ‚îÄ js/                  # JavaScript compartido
‚îÇ       ‚îú‚îÄ‚îÄ login.js
‚îÇ       ‚îú‚îÄ‚îÄ navbar.js
‚îÇ       ‚îú‚îÄ‚îÄ sidebar.js
‚îÇ       ‚îú‚îÄ‚îÄ panel.js
‚îÇ       ‚îî‚îÄ‚îÄ auth_guard.js
‚îú‚îÄ‚îÄ php/                      # Backend PHP compartido
‚îÇ   ‚îú‚îÄ‚îÄ db_postgres.php      # Conexi√≥n PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ db_sqlserver.php     # Conexi√≥n SQL Server
‚îÇ   ‚îú‚îÄ‚îÄ login_admin.php
‚îÇ   ‚îú‚îÄ‚îÄ login_colaborador.php
‚îÇ   ‚îú‚îÄ‚îÄ session_manager.php
‚îÇ   ‚îú‚îÄ‚îÄ session_management_api.php
‚îÇ   ‚îú‚îÄ‚îÄ verificar_sesion.php
‚îÇ   ‚îú‚îÄ‚îÄ logout.php
‚îÇ   ‚îú‚îÄ‚îÄ web_main_api.php
‚îÇ   ‚îú‚îÄ‚îÄ web_main_upload.php
‚îÇ   ‚îú‚îÄ‚îÄ sync_colaboradores.php
‚îÇ   ‚îî‚îÄ‚îÄ funciones_sync.php
‚îú‚îÄ‚îÄ db/                       # Scripts de base de datos
‚îÇ   ‚îú‚îÄ‚îÄ osm_postgres.sql
‚îÇ   ‚îú‚îÄ‚îÄ migration_adm_webmain.sql
‚îÇ   ‚îî‚îÄ‚îÄ verify_webmain_config.sql
‚îú‚îÄ‚îÄ m_admin/                  # M√≥dulo de administraci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ ed_usuario.html
‚îÇ   ‚îú‚îÄ‚îÄ ed_uscolaboradores.html
‚îÇ   ‚îú‚îÄ‚îÄ php/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usuarios_api.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ colaboradores_api.php
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îÇ       ‚îî‚îÄ‚îÄ js/
‚îÇ           ‚îú‚îÄ‚îÄ usuarios.js
‚îÇ           ‚îî‚îÄ‚îÄ colaboradores.js
‚îú‚îÄ‚îÄ m_capacitaciones/         # M√≥dulo de capacitaciones
‚îÇ   ‚îú‚îÄ‚îÄ formulario.html
‚îÇ   ‚îú‚îÄ‚îÄ ed_formulario.html
‚îÇ   ‚îú‚îÄ‚îÄ programacion.html
‚îÇ   ‚îú‚îÄ‚îÄ Consultas_capacitacion.html
‚îÇ   ‚îú‚îÄ‚îÄ plantilla_importacion.csv
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îÇ       ‚îú‚îÄ‚îÄ php/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ formulario_api.php
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ed_formulario_api.php
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ programacion_api.php
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ consultas_capacitacion_api.php
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ notificaciones_api.php
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ progreso_api.php
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ file_upload_api.php
‚îÇ       ‚îî‚îÄ‚îÄ js/
‚îÇ           ‚îú‚îÄ‚îÄ formulario.js
‚îÇ           ‚îú‚îÄ‚îÄ ed_formulario.js
‚îÇ           ‚îú‚îÄ‚îÄ programacion.js
‚îÇ           ‚îú‚îÄ‚îÄ consulta-cap.js
‚îÇ           ‚îî‚îÄ‚îÄ capacitaciones.js
‚îú‚îÄ‚îÄ m_agronomia/              # M√≥dulo agron√≥mico (98 archivos)
‚îÇ   ‚îú‚îÄ‚îÄ tb_agronomia.html
‚îÇ   ‚îú‚îÄ‚îÄ f_cortes.html
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îÇ       ‚îú‚îÄ‚îÄ php/             # 50+ APIs especializadas
‚îÇ       ‚îî‚îÄ‚îÄ js/              # Scripts del frontend
‚îú‚îÄ‚îÄ m_bascula/                # M√≥dulo de pesaje
‚îÇ   ‚îú‚îÄ‚îÄ Pesaje.html
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îî‚îÄ‚îÄ includes/                 # Componentes reutilizables
```

### Stack Tecnol√≥gico

**Frontend**:
- HTML5
- CSS3 + Bootstrap 5
- JavaScript (Vanilla + ES6)
- FontAwesome Icons
- XLSX.js (Procesamiento de Excel)

**Backend**:
- PHP 7.4+
- PostgreSQL 9.x / 17.x
- SQL Server (para sincronizaci√≥n de colaboradores)

**Arquitectura**:
- Patr√≥n MVC adaptado
- API RESTful con PHP
- Autenticaci√≥n basada en sesiones PHP
- SPA parcial (Single Page Application components)

---

## üìà Diagramas de Flujo

### 1. Flujo de Autenticaci√≥n

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario accede ‚îÇ
‚îÇ   a index.html  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Selecciona tipo de usuario:    ‚îÇ
‚îÇ  ‚Ä¢ Colaborador                  ‚îÇ
‚îÇ  ‚Ä¢ Administrador                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Ingresa credenciales:          ‚îÇ
‚îÇ  ‚Ä¢ C√©dula                       ‚îÇ
‚îÇ  ‚Ä¢ Contrase√±a                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  login.js env√≠a petici√≥n a:     ‚îÇ
‚îÇ  ‚Ä¢ login_colaborador.php  √≥     ‚îÇ
‚îÇ  ‚Ä¢ login_admin.php              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Backend valida en:             ‚îÇ
‚îÇ  ‚Ä¢ adm_colaboradores (Postgres) ‚îÇ
‚îÇ  ‚Ä¢ adm_usuarios (Postgres)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îú‚îÄ‚îÄ‚îÄ ‚ùå Credenciales inv√°lidas
         ‚îÇ    ‚îÇ
         ‚îÇ    ‚ñº
         ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ    ‚îÇ Registra intento fallido ‚îÇ
         ‚îÇ    ‚îÇ en adm_intentos_login    ‚îÇ
         ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ             ‚îÇ
         ‚îÇ             ‚ñº
         ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ    ‚îÇ Muestra error al usuario ‚îÇ
         ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ ‚úÖ Credenciales v√°lidas
              ‚îÇ
              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Crea sesi√≥n en:                ‚îÇ
‚îÇ  ‚Ä¢ adm_sesiones                 ‚îÇ
‚îÇ  ‚Ä¢ $_SESSION PHP                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Registra intento exitoso       ‚îÇ
‚îÇ  en adm_intentos_login          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Redirige a panel.html          ‚îÇ
‚îÇ  con datos de usuario en sesi√≥n ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2. Flujo del Sistema de Capacitaciones

#### 2.1 Registro de Nueva Capacitaci√≥n

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario accede a    ‚îÇ
‚îÇ  formulario.html     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  auth_guard.js verifica sesi√≥n  ‚îÇ
‚îÇ  y permisos del usuario         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  formulario.js carga cat√°logos: ‚îÇ
‚îÇ  ‚Ä¢ cap_tema                     ‚îÇ
‚îÇ  ‚Ä¢ cap_proceso                  ‚îÇ
‚îÇ  ‚Ä¢ cap_lugar                    ‚îÇ
‚îÇ  ‚Ä¢ cap_tipo_actividad           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario completa formulario:   ‚îÇ
‚îÇ  1. Selecciona proceso          ‚îÇ
‚îÇ  2. Selecciona lugar            ‚îÇ
‚îÇ  3. Ingresa responsable         ‚îÇ
‚îÇ  4. Selecciona tipo actividad   ‚îÇ
‚îÇ  5. Selecciona tema             ‚îÇ
‚îÇ  6. Ingresa fecha y hora        ‚îÇ
‚îÇ  7. Ingresa duraci√≥n            ‚îÇ
‚îÇ  8. Ingresa observaciones       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario agrega asistentes:     ‚îÇ
‚îÇ  ‚Ä¢ Opci√≥n 1: B√∫squeda manual    ‚îÇ
‚îÇ  ‚Ä¢ Opci√≥n 2: Importar CSV       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îú‚îÄ‚îÄ‚îÄ B√∫squeda Manual
           ‚îÇ    ‚îÇ
           ‚îÇ    ‚ñº
           ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ    ‚îÇ Busca en adm_colaboradores ‚îÇ
           ‚îÇ    ‚îÇ por c√©dula o nombre        ‚îÇ
           ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ             ‚îÇ
           ‚îÇ             ‚ñº
           ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ    ‚îÇ Agrega a lista de          ‚îÇ
           ‚îÇ    ‚îÇ asistentes (temporal)      ‚îÇ
           ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ Importar CSV
                ‚îÇ
                ‚ñº
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ file_upload_api.php procesa‚îÇ
                ‚îÇ plantilla_importacion.csv  ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ Valida c√©dulas contra      ‚îÇ
                ‚îÇ adm_colaboradores          ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ Agrega m√∫ltiples asistentes‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îÇ (Ambos flujos convergen)
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario adjunta archivo        ‚îÇ
‚îÇ  (opcional): PDF, DOCX, etc.    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario hace clic en "Guardar" ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  formulario.js env√≠a datos a    ‚îÇ
‚îÇ  formulario_api.php             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  formulario_api.php ejecuta:    ‚îÇ
‚îÇ  BEGIN TRANSACTION              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  INSERT INTO cap_formulario     ‚îÇ
‚îÇ  (datos de la capacitaci√≥n)     ‚îÇ
‚îÇ  RETURNING id                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Para cada asistente:           ‚îÇ
‚îÇ  INSERT INTO                    ‚îÇ
‚îÇ  cap_formulario_asistente       ‚îÇ
‚îÇ  (id_formulario, cedula)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Si hay archivo:                ‚îÇ
‚îÇ  Guarda en servidor y actualiza ‚îÇ
‚îÇ  cap_formulario.archivo_adjunto ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  COMMIT TRANSACTION             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Ejecuta funci√≥n:               ‚îÇ
‚îÇ  actualizar_notificaciones_     ‚îÇ
‚îÇ  capacitacion()                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Actualiza/Crea registros en    ‚îÇ
‚îÇ  cap_notificaciones para        ‚îÇ
‚îÇ  colaboradores afectados        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Muestra mensaje de √©xito       ‚îÇ
‚îÇ  y redirige a consultas         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 2.2 Programaci√≥n de Capacitaciones

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario accede a    ‚îÇ
‚îÇ  programacion.html   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  programacion.js carga:         ‚îÇ
‚îÇ  ‚Ä¢ cap_tema                     ‚îÇ
‚îÇ  ‚Ä¢ adm_cargos                   ‚îÇ
‚îÇ  ‚Ä¢ adm_roles (capacitadores)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario configura programa:    ‚îÇ
‚îÇ  1. Selecciona tema             ‚îÇ
‚îÇ  2. Selecciona cargo objetivo   ‚îÇ
‚îÇ  3. Selecciona sub-√°rea (opc.)  ‚îÇ
‚îÇ  4. Define frecuencia (meses)   ‚îÇ
‚îÇ  5. Asigna capacitador (rol)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  programacion_api.php ejecuta:  ‚îÇ
‚îÇ  INSERT INTO cap_programacion   ‚îÇ
‚îÇ  con activo=true                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Ejecuta trigger autom√°tico:    ‚îÇ
‚îÇ  actualizar_notificaciones_     ‚îÇ
‚îÇ  capacitacion()                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Para cada colaborador con      ‚îÇ
‚îÇ  cargo y sub-√°rea coincidentes: ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Verifica √∫ltima capacitaci√≥n   ‚îÇ
‚îÇ  en cap_formulario_asistente    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îú‚îÄ‚îÄ‚îÄ Sin capacitaci√≥n previa
           ‚îÇ    ‚îÇ
           ‚îÇ    ‚ñº
           ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ    ‚îÇ Crea notificaci√≥n con:     ‚îÇ
           ‚îÇ    ‚îÇ estado='pendiente'         ‚îÇ
           ‚îÇ    ‚îÇ fecha_proxima=HOY          ‚îÇ
           ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ Con capacitaci√≥n previa
                ‚îÇ
                ‚ñº
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ Calcula pr√≥xima fecha:     ‚îÇ
                ‚îÇ fecha_ultima +             ‚îÇ
                ‚îÇ frecuencia_meses           ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ Determina estado:          ‚îÇ
                ‚îÇ ‚Ä¢ vencida (pas√≥ fecha)     ‚îÇ
                ‚îÇ ‚Ä¢ proximo_vencer (<30 d√≠as)‚îÇ
                ‚îÇ ‚Ä¢ vigente (>30 d√≠as)       ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ INSERT/UPDATE              ‚îÇ
                ‚îÇ cap_notificaciones         ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Muestra programaci√≥n activa    ‚îÇ
‚îÇ  con contador de colaboradores  ‚îÇ
‚îÇ  afectados                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 2.3 Sistema de Notificaciones Autom√°ticas

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Funci√≥n PostgreSQL:            ‚îÇ
‚îÇ  actualizar_notificaciones_     ‚îÇ
‚îÇ  capacitacion()                 ‚îÇ
‚îÇ  (Se ejecuta autom√°ticamente)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PASO 1: Limpieza               ‚îÇ
‚îÇ  DELETE FROM cap_notificaciones ‚îÇ
‚îÇ  WHERE id_programacion IN       ‚îÇ
‚îÇ  (SELECT id FROM                ‚îÇ
‚îÇ   cap_programacion              ‚îÇ
‚îÇ   WHERE activo = false)         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PASO 2: Construcci√≥n de CTE    ‚îÇ
‚îÇ  ultima_capacitacion            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Para cada colaborador activo   ‚îÇ
‚îÇ  (ac_id_situaci√≥n IN A,V,P):    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  JOIN con cap_programacion      ‚îÇ
‚îÇ  WHERE activo=true              ‚îÇ
‚îÇ  AND cargo coincide             ‚îÇ
‚îÇ  AND sub_area coincide (o NULL) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LEFT JOIN con cap_formulario   ‚îÇ
‚îÇ  y cap_formulario_asistente     ‚îÇ
‚îÇ  para obtener fecha_ultima      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PASO 3: Inserci√≥n/Actualizaci√≥n‚îÇ
‚îÇ  INSERT INTO cap_notificaciones ‚îÇ
‚îÇ  ON CONFLICT (id_colaborador,   ‚îÇ
‚îÇ               id_programacion)  ‚îÇ
‚îÇ  DO UPDATE SET ...              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Calcula campos din√°micamente:  ‚îÇ
‚îÇ  ‚Ä¢ fecha_proxima                ‚îÇ
‚îÇ  ‚Ä¢ dias_para_vencimiento        ‚îÇ
‚îÇ  ‚Ä¢ estado (pendiente/vencida/   ‚îÇ
‚îÇ    proximo_vencer/vigente)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Notificaciones disponibles     ‚îÇ
‚îÇ  para consulta v√≠a              ‚îÇ
‚îÇ  notificaciones_api.php         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3. Flujo del M√≥dulo Agron√≥mico

#### 3.1 Registro de Fecha de Corte

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario accede a    ‚îÇ
‚îÇ  f_cortes.html       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Formulario solicita:           ‚îÇ
‚îÇ  ‚Ä¢ Fecha de corte               ‚îÇ
‚îÇ  ‚Ä¢ Observaciones                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Env√≠a a API agron√≥mica         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  INSERT INTO agr_fecha_corte    ‚îÇ
‚îÇ  (fecha_corte, observaciones,   ‚îÇ
‚îÇ   estado='activo')              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Actualiza dashboard con nueva  ‚îÇ
‚îÇ  fecha programada               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 3.2 Monitoreo de Plagas

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario en campo    ‚îÇ
‚îÇ  accede a m√≥dulo     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Registra observaci√≥n:          ‚îÇ
‚îÇ  ‚Ä¢ Lote afectado                ‚îÇ
‚îÇ  ‚Ä¢ Tipo de plaga                ‚îÇ
‚îÇ  ‚Ä¢ Nivel de incidencia          ‚îÇ
‚îÇ  ‚Ä¢ Foto (opcional)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  conexion_plagas.php procesa    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  INSERT en tabla de plagas      ‚îÇ
‚îÇ  con georeferencia y timestamp  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Genera alerta si supera        ‚îÇ
‚îÇ  umbral de incidencia           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  eventos_pendientes_            ‚îÇ
‚îÇ  operaciones.php notifica       ‚îÇ
‚îÇ  a supervisor                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 4. Flujo de Gesti√≥n de Sesiones

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario activo en el sistema   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Cada petici√≥n incluye          ‚îÇ
‚îÇ  session_id en cookie/header    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  verificar_sesion.php valida:   ‚îÇ
‚îÇ  ‚Ä¢ Existe session_id            ‚îÇ
‚îÇ  ‚Ä¢ Sesi√≥n activa en DB          ‚îÇ
‚îÇ  ‚Ä¢ No ha expirado               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îú‚îÄ‚îÄ‚îÄ ‚ùå Sesi√≥n inv√°lida
           ‚îÇ    ‚îÇ
           ‚îÇ    ‚ñº
           ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ    ‚îÇ Redirige a index.html    ‚îÇ
           ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ ‚úÖ Sesi√≥n v√°lida
                ‚îÇ
                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  auth_guard.js verifica permisos‚îÇ
‚îÇ  seg√∫n rol y p√°gina             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îú‚îÄ‚îÄ‚îÄ ‚ùå Sin permisos
           ‚îÇ    ‚îÇ
           ‚îÇ    ‚ñº
           ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ    ‚îÇ Muestra mensaje de error ‚îÇ
           ‚îÇ    ‚îÇ o redirige a dashboard   ‚îÇ
           ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ ‚úÖ Con permisos
                ‚îÇ
                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Permite acceso a recurso       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Usuario puede cerrar sesi√≥n:   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  logout.php ejecuta:            ‚îÇ
‚îÇ  UPDATE adm_sesiones            ‚îÇ
‚îÇ  SET activa = false,            ‚îÇ
‚îÇ      fecha_logout = NOW()       ‚îÇ
‚îÇ  WHERE session_id = ?           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  session_destroy() en PHP       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Redirige a index.html          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üóÑÔ∏è Base de Datos

### Diagrama de Relaciones Principales

```
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   adm_roles         ‚îÇ
                    ‚îÇ   (Roles)           ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                     ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ  adm_usuarios       ‚îÇ  ‚îÇ  adm_colaboradores   ‚îÇ
         ‚îÇ  (Administradores)  ‚îÇ  ‚îÇ  (Colaboradores)     ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ                     ‚îÇ
                    ‚îÇ                     ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ adm_usuario_roles   ‚îÇ  ‚îÇ  adm_cargos          ‚îÇ
         ‚îÇ (Asignaci√≥n roles)  ‚îÇ  ‚îÇ  (Cat√°logo cargos)   ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                           ‚îÇ
                                           ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   cap_programacion                   ‚îÇ
                    ‚îÇ   (Programaci√≥n capacitaciones)      ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                     ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ  cap_formulario     ‚îÇ  ‚îÇ  cap_notificaciones  ‚îÇ
         ‚îÇ  (Capacitaciones)   ‚îÇ  ‚îÇ  (Notificaciones)    ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ  cap_formulario_asistente   ‚îÇ
         ‚îÇ  (Asistentes)               ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Descripci√≥n de Tablas Principales

#### M√≥dulo de Administraci√≥n

**adm_usuarios** (Usuarios Administradores)
- `id` - Identificador √∫nico
- `cedula` - C√©dula del usuario
- `nombre`, `apellido` - Datos personales
- `password` - Contrase√±a hasheada
- `activo` - Estado del usuario

**adm_colaboradores** (Colaboradores - 1200+ registros)
- `ac_id` - Identificador √∫nico
- `ac_cedula` - C√©dula
- `ac_nombre1`, `ac_nombre2`, `ac_apellido1`, `ac_apellido2`
- `ac_empresa` - Empresa del grupo
- `ac_id_cargo` - FK a adm_cargos
- `ac_id_area`, `ac_sub_area` - √Årea organizacional
- `ac_id_situaci√≥n` - Estado (A=Activo, V=Vacaciones, P=Pendiente, etc.)
- `ac_contrase√±a` - Password hasheado
- `ac_id_rol` - FK a adm_roles

**adm_roles** (Roles del Sistema)
- `id` - Identificador
- `nombre` - Nombre del rol
- `descripcion` - Descripci√≥n
- Roles configurados: Administrador, Capacitador, Aux_Capacitador, Capacitador_SIE, etc.

**adm_cargos** (Cat√°logo de Cargos - 143 registros)
- `id_cargo` - C√≥digo de cargo
- `cargo` - Nombre del cargo
- `rango_cargo` - Rango organizacional (ANALISTAS, ASISTENTES, COORDINADORES, etc.)

**adm_sesiones** (Sesiones Activas)
- `id` - Identificador
- `session_id` - ID √∫nico de sesi√≥n PHP
- `usuario_id` - FK al usuario/colaborador
- `tipo_usuario` - 'admin' o 'colaborador'
- `activa` - Booleano de estado
- `fecha_login`, `fecha_logout` - Timestamps
- `ip_address`, `user_agent` - Datos de auditor√≠a

**adm_intentos_login** (Control de Intentos)
- `id` - Identificador
- `usuario_identificador` - C√©dula del usuario
- `exitoso` - Booleano de √©xito
- `ip_address` - IP de origen
- `fecha` - Timestamp del intento

**adm_webmain** (Configuraci√≥n Web)
- `id` - Identificador
- `site_title` - T√≠tulo del sitio
- `footer_text` - Texto del footer
- `favicon_path`, `login_image_path` - Rutas de im√°genes
- `primary_color` - Color primario del tema
- `is_active` - Configuraci√≥n activa
- `theme_name` - Nombre del tema

#### M√≥dulo de Capacitaciones

**cap_formulario** (Registro de Capacitaciones)
- `id` - Identificador √∫nico
- `fecha`, `hora_inicio`, `duracion` - Programaci√≥n temporal
- `id_tema` - FK a cap_tema
- `id_tipo_actividad` - FK a cap_tipo_actividad
- `id_proceso` - FK a cap_proceso
- `id_lugar` - FK a cap_lugar
- `id_usuario` - FK al responsable
- `cedula_responsable` - C√©dula del capacitador
- `nombre_responsable` - Nombre del capacitador
- `observaciones` - Notas adicionales
- `archivo_adjunto` - Ruta del archivo
- `creado_por`, `editado_por` - Auditor√≠a
- `fecha_creacion`, `fecha_edicion` - Timestamps

**cap_formulario_asistente** (Asistentes por Capacitaci√≥n)
- `id` - Identificador
- `id_formulario` - FK a cap_formulario (CASCADE DELETE)
- `cedula` - C√©dula del asistente
- `nombre` - Nombre del asistente

**cap_programacion** (Programaci√≥n por Cargo)
- `id` - Identificador
- `id_tema` - FK a cap_tema
- `id_cargo` - FK a adm_cargos
- `sub_area` - Sub-√°rea espec√≠fica (NULL = todas)
- `frecuencia_meses` - Frecuencia requerida (default 12)
- `id_rol_capacitador` - FK al rol responsable
- `fecha_creacion` - Timestamp
- `activo` - Booleano de estado

**cap_notificaciones** (Notificaciones de Vencimiento)
- `id` - Identificador
- `id_colaborador` - FK a adm_colaboradores
- `id_programacion` - FK a cap_programacion
- `fecha_ultima_capacitacion` - √öltima vez capacitado
- `fecha_proxima` - Pr√≥xima capacitaci√≥n requerida
- `dias_para_vencimiento` - D√≠as restantes
- `estado` - 'pendiente', 'vigente', 'proximo_vencer', 'vencida'
- `leida` - Booleano de lectura
- `fecha_actualizacion` - Timestamp
- Constraint UNIQUE: (id_colaborador, id_programacion)

**cap_tema** (Cat√°logo de Temas - 81 registros)
- `id` - Identificador
- `nombre` - Nombre del tema
- Ejemplos: "Trabajo en equipo", "Principios RSPO", "BPM e inocuidad alimentaria", etc.

**cap_tipo_actividad** (Tipos de Actividad - 5 registros)
- `id` - Identificador
- `nombre` - Tipo (Capacitaci√≥n, Charla, Reuni√≥n, Entrenamiento, Inducci√≥n)

**cap_lugar** (Lugares de Capacitaci√≥n)
- `id` - Identificador
- `nombre` - Nombre del lugar

**cap_proceso** (Procesos Asociados)
- `id` - Identificador
- `nombre` - Nombre del proceso

**v_progreso_capacitaciones** (Vista de Progreso)
- Vista calculada que muestra:
  - Datos del colaborador
  - Capacitaciones programadas
  - Capacitaciones realizadas
  - Porcentaje de completitud

#### M√≥dulo Agron√≥mico

**agr_fecha_corte** (Programaci√≥n de Cortes)
- `id_fc` - Identificador
- `fecha_corte` - Fecha programada
- `observaciones` - Notas
- (Nota: Este m√≥dulo tiene muchas m√°s tablas para diferentes sub-procesos)

### Funciones y Triggers de PostgreSQL

**actualizar_notificaciones_capacitacion()**
- Funci√≥n PL/pgSQL que se ejecuta autom√°ticamente
- Limpia notificaciones de programas inactivos
- Calcula notificaciones para cada colaborador
- Determina estado seg√∫n fechas y frecuencia
- Se invoca tras INSERT/UPDATE en cap_formulario y cap_programacion

**trigger_set_updated_at()**
- Actualiza campo `updated_at` autom√°ticamente
- Se dispara BEFORE UPDATE en tablas con timestamp

### An√°lisis de Compatibilidad con PostgreSQL v9

#### ‚úÖ Caracter√≠sticas Compatibles con PostgreSQL 9.x:

1. **Sequences**: Todas las secuencias usan sintaxis est√°ndar compatible
2. **Data Types**: varchar, int4, date, timestamp, bool - todos soportados desde PG 9.0
3. **Indexes**: CREATE INDEX est√°ndar - compatible
4. **Foreign Keys**: Sintaxis ON DELETE CASCADE - compatible desde PG 9.0
5. **Functions**: PL/pgSQL b√°sico - compatible
6. **Triggers**: BEFORE UPDATE triggers - compatible
7. **Views**: CREATE VIEW - compatible
8. **CTEs**: WITH clauses - soportadas desde PG 8.4
9. **RETURNING**: Cl√°usula RETURNING en INSERT - desde PG 8.2

#### ‚ö†Ô∏è Caracter√≠sticas que Requieren PostgreSQL 9.5+:

1. **INSERT ... ON CONFLICT** (usado en `actualizar_notificaciones_capacitacion()`)
   - Introducido en PostgreSQL 9.5
   - **Soluci√≥n para PG 9.x**: Usar UPDATE seguido de INSERT condicional

#### ‚ö†Ô∏è Caracter√≠sticas que Requieren PostgreSQL 10+:

1. **IDENTITY Columns** (usado en `migration_adm_webmain.sql`)
   - `id integer GENERATED BY DEFAULT AS IDENTITY`
   - Introducido en PostgreSQL 10
   - **Soluci√≥n para PG 9.x**: Usar SERIAL o crear secuencia manualmente

#### üîß Modificaciones Necesarias para PostgreSQL 9.x:

**Para `migration_adm_webmain.sql`:**
```sql
-- En lugar de:
id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,

-- Usar:
id SERIAL PRIMARY KEY,
-- O:
id integer DEFAULT nextval('adm_webmain_id_seq'::regclass) PRIMARY KEY,
```

**Para `actualizar_notificaciones_capacitacion()`:**
```sql
-- En lugar de:
INSERT INTO cap_notificaciones (...)
VALUES (...)
ON CONFLICT (id_colaborador, id_programacion) 
DO UPDATE SET ...

-- Usar:
UPDATE cap_notificaciones SET ...
WHERE id_colaborador = ? AND id_programacion = ?;

IF NOT FOUND THEN
  INSERT INTO cap_notificaciones (...) VALUES (...);
END IF;
```

#### ‚úÖ Conclusi√≥n de Compatibilidad:

El sistema es **95% compatible con PostgreSQL 9.x** con modificaciones menores:
1. Cambiar IDENTITY a SERIAL (1 tabla afectada)
2. Reemplazar ON CONFLICT con l√≥gica UPDATE/INSERT (1 funci√≥n afectada)
3. Todo lo dem√°s funciona sin cambios

---

## üöÄ Instalaci√≥n

### Requisitos Previos

- **Servidor Web**: Apache 2.4+ o Nginx
- **PHP**: 7.4 o superior
  - Extensiones requeridas: pdo, pdo_pgsql, pdo_sqlsrv, session, json
- **PostgreSQL**: 9.6+ (recomendado 17.x)
- **SQL Server**: Para sincronizaci√≥n de colaboradores (opcional)
- **Navegador**: Chrome, Firefox, Edge (versiones recientes)

### Pasos de Instalaci√≥n

1. **Clonar el repositorio**
```bash
git clone https://github.com/Leonardom97/OSM.git
cd OSM
```

2. **Configurar Base de Datos PostgreSQL**
```bash
# Crear base de datos
createdb osm2

# Ejecutar script principal
psql -U postgres -d osm2 -f db/osm_postgres.sql

# Ejecutar migraci√≥n de configuraci√≥n web
psql -U postgres -d osm2 -f db/migration_adm_webmain.sql

# Verificar instalaci√≥n
psql -U postgres -d osm2 -f db/verify_webmain_config.sql
```

3. **Configurar Conexiones PHP**

Editar `php/db_postgres.php`:
```php
$host = 'localhost';
$port = '5432';
$dbname = 'osm2';
$user = 'postgres';
$password = 'tu_password';
```

Editar `php/db_sqlserver.php` (si aplica):
```php
$serverName = "tu_servidor";
$connectionOptions = array(
    "Database" => "tu_base_datos",
    "Uid" => "usuario",
    "PWD" => "password"
);
```

4. **Configurar Permisos**
```bash
# Dar permisos de escritura a carpetas de uploads
chmod 755 uploads/
chmod 755 m_capacitaciones/uploads/
```

5. **Configurar Virtual Host**

Para Apache:
```apache
<VirtualHost *:80>
    ServerName osm.local
    DocumentRoot /path/to/OSM
    <Directory /path/to/OSM>
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```

6. **Acceder al Sistema**

- Abrir navegador en `http://osm.local` o `http://localhost/OSM`
- Credenciales de prueba (si existen en DB):
  - Administrador: C√©dula del usuario en `adm_usuarios`
  - Colaborador: C√©dula del colaborador en `adm_colaboradores`

### Configuraci√≥n Inicial

1. **Crear Usuario Administrador**
```sql
INSERT INTO adm_usuarios (cedula, nombre, apellido, password, activo)
VALUES ('1234567890', 'Admin', 'Sistema', '...hash...', true);

INSERT INTO adm_usuario_roles (usuario_id, rol_id)
VALUES (1, 1); -- Rol Administrador
```

2. **Sincronizar Colaboradores** (si se usa SQL Server)
```bash
# Ejecutar script de sincronizaci√≥n
php php/sync_colaboradores.php
```

3. **Configurar Temas de Capacitaci√≥n**
- Los 81 temas ya est√°n pre-cargados en la base de datos

4. **Configurar Web**
- Acceder a configuraci√≥n web (si existe interfaz)
- O modificar directamente en `adm_webmain`

---

## üíª Tecnolog√≠as Utilizadas

### Frontend
- **HTML5**: Estructura sem√°ntica
- **CSS3**: Estilos personalizados
- **Bootstrap 5.x**: Framework CSS responsivo
- **JavaScript ES6+**: L√≥gica del cliente
- **FontAwesome 6**: Iconograf√≠a
- **XLSX.js**: Procesamiento de archivos Excel

### Backend
- **PHP 7.4+**: Lenguaje del servidor
- **PostgreSQL 9.x/17.x**: Base de datos principal
- **SQL Server**: Sincronizaci√≥n de datos externos (opcional)

### Arquitectura
- **Patr√≥n MVC**: Separaci√≥n de capas
- **REST API**: APIs PHP para operaciones CRUD
- **Session-based Auth**: Autenticaci√≥n con sesiones PHP
- **SPA Components**: Componentes de aplicaci√≥n de p√°gina √∫nica

### Herramientas de Desarrollo
- **Git**: Control de versiones
- **Navicat**: Gesti√≥n de base de datos
- **Visual Studio Code**: Editor de c√≥digo
- **Chrome DevTools**: Depuraci√≥n

---

## üìö Documentaci√≥n Adicional

### Estructura de Roles

| Rol | Descripci√≥n | Permisos |
|-----|-------------|----------|
| Administrador | Acceso total | Todos los m√≥dulos |
| Capacitador | Gesti√≥n de capacitaciones | M√≥dulo m_capacitaciones |
| Aux_Capacitador | Asistente de capacitaciones | Lectura y creaci√≥n |
| Capacitador_SIE | Capacitador de Sistemas | Capacitaciones de TI |
| Capacitador_GH | Capacitador de RRHH | Capacitaciones de Gesti√≥n Humana |
| Capacitador_TI | Capacitador T√©cnico | Capacitaciones t√©cnicas |
| Capacitador_MT | Capacitador de Mantenimiento | Capacitaciones de mantenimiento |
| Capacitador_ADM | Capacitador Administrativo | Capacitaciones administrativas |
| Capacitador_IND | Capacitador Industrial | Capacitaciones de planta |
| Capacitador_AGR | Capacitador Agr√≠cola | Capacitaciones agron√≥micas |
| Colaborador | Usuario b√°sico | Dashboard y consultas |

### Estados de Colaborador

- **A** (Activo): Colaborador activo trabajando
- **V** (Vacaciones): Colaborador en vacaciones
- **P** (Pendiente): Colaborador con situaci√≥n pendiente
- **E** (Egresado/Inactivo): Colaborador que ya no trabaja
- **X** (Otro): Situaci√≥n especial

### Certificaciones y Cumplimiento

El sistema soporta el cumplimiento de:
- **RSPO** (Roundtable on Sustainable Palm Oil)
- **ISCC** (International Sustainability and Carbon Certification)
- **Certificaci√≥n Org√°nica**

---

## üë• Contacto y Soporte

**Desarrollado para**: Empresa Agroindustrial de Aceite de Palma  
**A√±o**: 2025  
**Versi√≥n**: 1.0.0  

---

## üìÑ Licencia

¬© OSM 2025 - Todos los derechos reservados

---

## üîÑ Changelog

### Versi√≥n 1.0.0 (2025-10-25)
- ‚úÖ Implementaci√≥n inicial del sistema
- ‚úÖ M√≥dulo de Administraci√≥n completo
- ‚úÖ M√≥dulo de Capacitaciones con notificaciones
- ‚úÖ M√≥dulo Agron√≥mico base
- ‚úÖ M√≥dulo de B√°scula
- ‚úÖ Sistema de autenticaci√≥n dual
- ‚úÖ Dashboard principal
- ‚úÖ 81 temas de capacitaci√≥n pre-configurados
- ‚úÖ Base de datos con 1200+ colaboradores

---

**√öltima actualizaci√≥n**: 30 de Octubre de 2025
